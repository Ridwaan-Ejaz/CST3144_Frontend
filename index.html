<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>After School Activities</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.7.16/dist/vue.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="app">
    <h1>After School Activities</h1>

    <!-- Lessons Page -->
    <div v-if="currentView === 'lessons'">
      <div class="controls">
        <label>Sort by:</label>
        <select v-model="sortKey">
          <option value="subject">Activity</option>
          <option value="location">Location</option>
          <option value="price">Price</option>
          <option value="spaces">Spaces</option>
        </select>

        <select v-model="sortOrder">
          <option value="asc">Ascending</option>
          <option value="desc">Descending</option>
        </select>

        <button
          :disabled="cart.length === 0"
          @click="currentView = 'cart'"
        >
          View Cart ({{ totalItems }})
        </button>
      </div>

      <div class="lessons">
        <div class="lesson" v-for="lesson in sortedLessons" :key="lesson.id">
          <h3>{{ lesson.subject }}</h3>
          <p>Location: {{ lesson.location }}</p>
          <p>Price: ${{ lesson.price }}</p>
          <p>Spaces: {{ lesson.spaces }}</p>
          <button @click="addToCart(lesson)" :disabled="lesson.spaces === 0">
            Add to Cart
          </button>
        </div>
      </div>
    </div>

    <!-- Cart Page -->
    <div v-if="currentView === 'cart'" class="cart-page">
      <h2>Your Cart</h2>

      <ul v-if="cart.length > 0">
        <li v-for="item in cart" :key="item.lessonId">
          {{ item.subject }} — ${{ item.price }} × {{ item.quantity }}
          <button class="remove-btn" @click="removeItem(item)">Remove</button>
        </li>
      </ul>

      <p v-else>Your cart is empty.</p>

      <button @click="currentView = 'lessons'">Back to Lessons</button>
    </div>

  </div>

  <script>
    new Vue({
      el: '#app',
      data: {
        currentView: 'lessons',
        sortKey: 'subject',
        sortOrder: 'asc',

        lessons: [
          { id: 1, subject: 'Math Club', location: 'Hendon', price: 100, spaces: 5 },
          { id: 2, subject: 'Science Lab', location: 'Dubai', price: 80, spaces: 3 },
          { id: 3, subject: 'English Reading', location: 'Colindale', price: 90, spaces: 2 }
        ],

        cart: []
      },
      computed: {
        sortedLessons() {
          return this.lessons.slice().sort((a, b) => {
            let mod = this.sortOrder === 'asc' ? 1 : -1;
            if (a[this.sortKey] < b[this.sortKey]) return -1 * mod;
            if (a[this.sortKey] > b[this.sortKey]) return 1 * mod;
            return 0;
          });
        },
        totalItems() {
          return this.cart.reduce((sum, item) => sum + item.quantity, 0);
        }
      },
      methods: {
        addToCart(lesson) {
          if (lesson.spaces === 0) return;

          let existing = this.cart.find(i => i.lessonId === lesson.id);

          if (existing) {
            existing.quantity++;
          } else {
            this.cart.push({
              lessonId: lesson.id,
              subject: lesson.subject,
              price: lesson.price,
              quantity: 1
            });
          }

          lesson.spaces--;
        },

        removeItem(item) {
          let lesson = this.lessons.find(l => l.id === item.lessonId);

          if (lesson) {
            lesson.spaces += item.quantity;
          }

          this.cart = this.cart.filter(i => i.lessonId !== item.lessonId);
        }
      }
    });
  </script>
</body>
</html>
